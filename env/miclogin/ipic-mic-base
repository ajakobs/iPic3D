#%Module1.0####################################################################
##
##  mymodule modulefile
##
##  My new module that sets my personal environment
##
proc ModulesHelp { } {
        puts stderr "\tset environment to compile and run iPic3D on MIC for given HDF5_ROOT"
}

## Create a whatis file.  Not necessary but cool.
module-whatis   "set environment to run iPic3D on MIC"

### stuff needed to compile ###


module load intel/2015.1.133
module load parastation/psmpi-intel-mic-mt-5.1.1-1_9_gc3ebd7b
module load parastation/pscom/pscom

setenv CXX mpicxx
setenv CC mpicc
setenv FC mpif90

#prepend-path PATH /opt/intel/composer_xe_2013_sp1.1.106/bin/intel64_mic:/opt/intel/composer_xe_2013_sp1.1.106/mpirt/bin/mic

# stuff needed for OmpSs offloading
#
#module load OmpSs
# library needed if you want to use nanox to offload
setenv IPIC_MPIRUN mpiexec

prepend-path PATH $env(IPIC_HOME)/scripts

# set up mpiexec
#
# This is needed in order to find the appropriate mpiexec.hydra,
# but then the build is wrong ...
#prepend-path PATH=/opt/intel/impi/4.1.2.040/intel64/bin:$PATH
# ... so instead we directly access the binary:
# conveniences to override the bad guys
setenv IPIC_RUNENV miclogin.mic

### stuff needed to run ###

prepend-path PATH $env(IPIC_HOME)/scripts
